// *********************************************************************************************
// Subroutine qui charge certaines colonnes des ententes à la source en utilisant la commande
// SQL. Par défaut, tous les champs sont qualifiés.
//
// @param vColumns : Liste des colonnes à charger délimités par virgule
// @param vWhereCondition : Condition dans le WHERE du SQL
// @param vFieldsNotToAlias : Liste de champs à ne pas aliaser
// *********************************************************************************************
Sub sub_sql_ba_po_entente_achat_v(vColumns, vWhereCondition, vFieldsNotToAlias)
    
    // ---------------------------------------------------------------------------------------
    // Chargement des ententes sur certaines colonnnes avec (ou pas) de condition WHERE
    // ---------------------------------------------------------------------------------------
    Qualify *;
    Unqualify $(vFieldsNotToAlias);
	If(vWhereCondition='' Or IsNull(vWhereCondition)) Then
    	// Select basé sur le paramètre reçu
        BA_PO_ENTENTE_ACHAT_V:
        SQL SELECT 
            $(vColumns)
        FROM BAVDM."BA_PO_ENTENTE_ACHAT_V";
    Else
    	// Select basé sur le paramètre reçu ainsi que la condition WHERE
        BA_PO_ENTENTE_ACHAT_V:
        SQL SELECT 
            $(vColumns)
        FROM BAVDM."BA_PO_ENTENTE_ACHAT_V"
        WHERE $(vWhereCondition);
    End If;
    Unqualify *;

End Sub;